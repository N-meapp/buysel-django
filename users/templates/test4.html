<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Share Payment Details</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      flex-direction: column;
      gap: 20px;
    }

    .card {
      width: 300px;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 10px;
      text-align: center;
      background-color: #fff;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .card h2 {
      font-size: 20px;
      margin-bottom: 10px;
      color: #333;
    }

    .card p {
      font-size: 16px;
      margin: 5px 0;
      color: #555;
    }

    button {
      margin-top: 15px;
      padding: 10px 20px;
      font-size: 14px;
      background-color: #25D366;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="card" id="card-1">
    <h2>Payment Successful</h2>
    <p>To: ashif</p>
    <p>Amount: ₹20</p>
    <p>UPI Transaction ID: 502448373</p>
    <p>You earned 2.0% cashback!</p>
    <button class="share-btn" data-id="1"
    data-message="Looking to buy or sell property? buysel.in offers great deals for buyers and quick listings for sellers. Find homes, apartments, and commercial spaces at the best prices. https://buysel.in/#card-1" 
    data-url="https://buysel.in/#card-1">Share</button>
  </div>

  <div class="card" id="card-2">
    <h2>Payment Successful</h2>
    <p>To: john</p>
    <p>Amount: ₹50</p>
    <p>UPI Transaction ID: 502448374</p>
    <p>You earned 1.5% cashback!</p>
    <button class="share-btn" data-id="2"
    data-message="Looking to buy or sell property? buysel.in offers great deals for buyers and quick listings for sellers. Find homes, apartments, and commercial spaces at the best prices. https://buysel.in/#card-2"
    data-url="https://buysel.in/#card-2">Share</button>
  </div>

  <div class="card" id="card-3">
    <h2>Payment Successful</h2>
    <p>To: mike</p>
    <p>Amount: ₹100</p>
    <p>UPI Transaction ID: 502448375</p>
    <p>You earned 3.0% cashback!</p>
    <button class="share-btn" data-id="3"
    data-message="Looking to buy or sell property? buysel.in offers great deals for buyers and quick listings for sellers. Find homes, apartments, and commercial spaces at the best prices. https://buysel.in/#card-3" 
    data-url="https://buysel.in/#card-3">Share</button>
  </div>

  <script>
document.querySelectorAll(".share-btn").forEach(button => {
  button.addEventListener("click", async (e) => {
    const button = e.target;
    const cardId = button.getAttribute("data-id");
    const message = button.getAttribute("data-message");
    const url = button.getAttribute("data-url");
    const card = document.getElementById(`${cardId}`);

    console.log();
    // Generate an image of the card
    const canvas = await html2canvas(card);
    const dataUrl = canvas.toDataURL("image/png");

    // Convert base64 image to a Blob
    const byteString = atob(dataUrl.split(",")[1]);
    const mimeString = dataUrl.split(",")[0].split(":")[1].split(";")[0];
    const buffer = new Uint8Array(byteString.length);
    for (let i = 0; i < byteString.length; i++) {
      buffer[i] = byteString.charCodeAt(i);
    }
    const blob = new Blob([buffer], { type: mimeString });
    const file = new File([blob], "payment-details.png", { type: "image/png" });

    const shareData = {
      title: "Payment Details",
      text: message,
      files: [file] // Include the image file
    };

    // Check for Web Share API support
    if (navigator.share) {
      try {
        // Share with image and message
        await navigator.share(shareData);
        console.log("Shared successfully!");
      } catch (error) {
        console.error("Error sharing with file:", error);
        // Fallback for unsupported devices or errors
        fallbackShare(message, url);
      }
    } else {
      fallbackShare(message, url); // Use fallback on unsupported devices
    }
  });
});

// Fallback method for unsupported browsers or when sharing fails
function fallbackShare(message, url) {
  const shareUrl = `whatsapp://send?text=${encodeURIComponent(`${message} ${url}`)}`;
  window.open(shareUrl, "_blank");
}
  </script>
</body>
</html>
